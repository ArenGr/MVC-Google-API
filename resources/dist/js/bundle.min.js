function loadMapScript(){const t=new XMLHttpRequest;let s=document.getElementById("autocomplete"),a=document.getElementById("suggestions");s.addEventListener("input",function(){t.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{a.innerHTML="",JSON.parse(this.responseText).forEach(function(t){var e=document.createElement("li");e.classList.add("list-group-item"),e.classList.add("item"),e.textContent=t[1],e.setAttribute("data-place-id",t[0]),a.appendChild(e),e.addEventListener("mouseenter",function(){e.style.backgroundColor="#f0f0f0"}),e.addEventListener("mouseleave",function(){e.style.backgroundColor=""}),e.addEventListener("click",function(t){t.target&&t.target.matches("li.item")&&(s.value=t.target.textContent,a.innerHTML="",getDetails(e.getAttribute("data-place-id")))})})}catch(t){console.log(t)}},t.open("GET","http://localhost:8000/google/maps/autocomplete/?input="+s.value,!0),t.send()})}function getDetails(t){var e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{getImage((res=JSON.parse(this.responseText)).location.lat,res.location.lng),storeAddressDetails(res.address)}catch(t){console.log(t)}},e.open("GET","http://localhost:8000/google/maps/coordinates/?placeId="+t,!0),e.send()}function getImage(t,e){var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{document.getElementById("mapImage").src="data:image/png;base64,"+this.responseText}catch(t){console.log(t)}},s.open("GET","http://localhost:8000/google/maps/image/?lat="+t+"&lng="+e,!0),s.send()}function storeAddressDetails(a){var t=["street_number","route","sublocality_level_1","locality","administrative_area_level_1","country"].reduce((t,e)=>{var s=a.find(t=>t.types.includes(e));return t[e]=s?s.long_name:null,t},{}),e=new XMLHttpRequest;e.onreadystatechange=function(){if(4==this.readyState)if(200==this.status)try{getAddressDetails()}catch(t){console.log(t)}else console.error("Request failed with status: "+this.status)},t=JSON.stringify(t),e.open("POST","http://localhost:8000/requests/store",!0),e.send(t)}function getAddressDetails(){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{var t=document.querySelector("tbody");let e="";JSON.parse(this.responseText).forEach(function(t){e=(e=(e=(e=(e=(e=(e=(e+="<tr>")+"<td>"+(t.street_number??"")+"</td>")+"<td>"+(t.route??"")+"</td>")+"<td>"+(t.sublocality_level_1??"")+"</td>")+"<td>"+(t.locality??"")+"</td>")+"<td>"+(t.administrative_area_level_1??"")+"</td>")+"<td>"+(t.country??"")+"</td>")+"<td>"+(t.created_at??"")+"</td></tr>"}),t.innerHTML=e}catch(t){console.log(t)}},t.open("GET","http://localhost:8000/requests/all",!0),t.send()}window.onload=loadMapScript;