function initAutocomplete(){var t=document.getElementById("autocomplete"),e=new google.maps.places.Autocomplete(t);e.addListener("place_changed",function(){var t=e.getPlace();t.geometry&&t.geometry.location?(fetchMapByCoordinates(t.geometry.location.lat(),t.geometry.location.lng()),postMapData(t.address_components),populateAddressDetails()):window.alert("No details available for input: '"+t.name+"'")})}function fetchMapByCoordinates(t,e){var a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{document.getElementById("mapImage").src="data:image/png;base64,"+this.responseText}catch(t){console.log(t)}},a.open("GET","http://localhost:8000/map/?lat="+t+"&lng="+e,!0),a.send()}function postMapData(t){expectedTypes=["street_number","route","sublocality_level_1","locality","administrative_area_level_1","country"],res=t.reduce((t,e)=>(expectedTypes.includes(e.types[0])&&(t[e.types[0]]=e.long_name),t),{});t=new XMLHttpRequest;t.onreadystatechange=function(){4==this.readyState&&200!=this.status&&console.error("Request failed with status: "+this.status)},res=JSON.stringify(res),t.open("POST","http://localhost:8000/requests/store",!0),t.send(res)}function populateAddressDetails(){var t=new XMLHttpRequest;t.onreadystatechange=function(){if(4==this.readyState&&200==this.status)try{var t=document.querySelector("tbody"),e="";JSON.parse(this.responseText).forEach(function(t){e=(e=(e=(e=(e=(e=(e=(e+="<tr>")+"<td>"+t.street_number+"</td>")+"<td>"+t.route+"</td>")+"<td>"+t.sublocality_level_1+"</td>")+"<td>"+t.locality+"</td>")+"<td>"+t.administrative_area_level_1+"</td>")+"<td>"+t.country+"</td>")+"<td>"+t.created_at+"</td></tr>"}),t.innerHTML=e}catch(t){console.log(t)}},t.open("GET","http://localhost:8000/requests/all",!0),t.send()}function loadMapScript(){var t=document.createElement("script");t.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCXyqIwIDS9w_6r5zqQErhSGNSpQ1TbNXM&libraries=places&callback=initAutocomplete",document.body.appendChild(t)}window.onload=loadMapScript;